# æƒ…å ±ã‚¿ãƒ–æ©Ÿèƒ½ è¨­è¨ˆæ›¸

## 1. æ©Ÿèƒ½æ¦‚è¦

### ç›®çš„
æ—…è¡Œã«å¿…è¦ãªèˆªç©ºåˆ¸ã€ãƒ›ãƒ†ãƒ«äºˆç´„ã€ãƒ¬ãƒ³ã‚¿ã‚«ãƒ¼ã€ä¿é™ºãªã©ã®æƒ…å ±ã‚’PDFãƒ»ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã§ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã€ã‚°ãƒ«ãƒ¼ãƒ—ãƒ¡ãƒ³ãƒãƒ¼å…¨å“¡ã§å…±æœ‰ãƒ»é–²è¦§ã§ãã‚‹æ©Ÿèƒ½ã€‚

### ä¸»è¦æ©Ÿèƒ½
- ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼ˆPDFã€ç”»åƒï¼‰
- ã‚«ãƒ†ã‚´ãƒªãƒ¼åˆ¥æ•´ç†
- ãƒ–ãƒ©ã‚¦ã‚¶å†…ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ä¸è¦ï¼‰
- ç·¨é›†ãƒ»å‰Šé™¤æ©Ÿèƒ½
- ã‚°ãƒ«ãƒ¼ãƒ—ãƒ¡ãƒ³ãƒãƒ¼é–“ã§ã®å…±æœ‰

---

## 2. UI/UXè¨­è¨ˆ

### 2.1 ã‚¿ãƒ–ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³
æ—¢å­˜ã®ã‚¿ãƒ–ã«ã€Œæƒ…å ±ã€ã‚’è¿½åŠ ï¼š
- æ—…è¡Œãƒ—ãƒ©ãƒ³
- ãƒãƒƒãƒ—
- äºˆç®—
- **æƒ…å ±** â† æ–°è¦è¿½åŠ 

### 2.2 ãƒ¡ã‚¤ãƒ³ç”»é¢ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æƒ…å ±                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [+ æƒ…å ±ã‚’è¿½åŠ ]                   â”‚
â”‚                                 â”‚
â”‚ â”Œâ”€ ã‚«ãƒ†ã‚´ãƒªãƒ¼ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ ã™ã¹ã¦ â”‚ âœˆï¸ â”‚ ğŸ¨ â”‚ ğŸš— â”‚ ğŸ“‹ â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                 â”‚
â”‚ âœˆï¸ èˆªç©ºåˆ¸                        â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚ â”‚ ANA123ä¾¿                â”‚     â”‚
â”‚ â”‚ 2024/12/25 10:00-12:00  â”‚     â”‚
â”‚ â”‚ æˆç”° â†’ é‚£è¦‡             â”‚     â”‚
â”‚ â”‚ äºˆç´„ç•ªå·: ABC123        â”‚     â”‚
â”‚ â”‚ ğŸ“ eticket.pdf          â”‚     â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                 â”‚
â”‚ ğŸ¨ ãƒ›ãƒ†ãƒ«                        â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚ â”‚ ãƒªã‚¾ãƒ¼ãƒˆãƒ›ãƒ†ãƒ«æ²–ç¸„       â”‚     â”‚
â”‚ â”‚ 12/25 - 12/27 (2æ³Š)     â”‚     â”‚
â”‚ â”‚ äºˆç´„ç•ªå·: HOTEL456      â”‚     â”‚
â”‚ â”‚ ğŸ“ booking.pdf, room.jpg â”‚     â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.3 è©³ç´°è¡¨ç¤ºãƒ¢ãƒ¼ãƒ€ãƒ«ï¼ˆPDFï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ã— ANA123ä¾¿                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                         â”‚   â”‚
â”‚  â”‚   PDFãƒ“ãƒ¥ãƒ¼ã‚¢ãƒ¼          â”‚   â”‚
â”‚  â”‚   ï¼ˆèˆªç©ºåˆ¸ã®å†…å®¹ï¼‰        â”‚   â”‚
â”‚  â”‚                         â”‚   â”‚
â”‚  â”‚                         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                 â”‚
â”‚  ãƒšãƒ¼ã‚¸: 1 / 2  [< >]           â”‚
â”‚                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ğŸ“¥ ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰] [ğŸ—‘ï¸ å‰Šé™¤]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.4 è©³ç´°è¡¨ç¤ºãƒ¢ãƒ¼ãƒ€ãƒ«ï¼ˆç”»åƒï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ã— ãƒªã‚¾ãƒ¼ãƒˆãƒ›ãƒ†ãƒ«æ²–ç¸„ (2/3)       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                         â”‚   â”‚
â”‚  â”‚   ç”»åƒãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³      â”‚   â”‚
â”‚  â”‚   ï¼ˆãƒ”ãƒ³ãƒã‚ºãƒ¼ãƒ å¯¾å¿œï¼‰    â”‚   â”‚
â”‚  â”‚                         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                 â”‚
â”‚  < â—‹ â— â—‹ >  (ã‚¹ãƒ¯ã‚¤ãƒ—åˆ‡æ›¿)     â”‚
â”‚                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ğŸ“¥ ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰] [ğŸ—‘ï¸ å‰Šé™¤]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.5 è¿½åŠ ãƒ¢ãƒ¼ãƒ€ãƒ«

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ã— æƒ…å ±ã‚’è¿½åŠ                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ã‚¿ã‚¤ãƒˆãƒ«                        â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚ â”‚ ANA123ä¾¿                â”‚     â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                 â”‚
â”‚ ã‚«ãƒ†ã‚´ãƒªãƒ¼                      â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚ â”‚ âœˆï¸ èˆªç©ºåˆ¸ â–¼             â”‚     â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                 â”‚
â”‚ æ—¥æ™‚ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰               â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”             â”‚
â”‚ â”‚12/25  â”‚ â”‚10:00â”‚             â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                 â”‚
â”‚ äºˆç´„ç•ªå·ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰           â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚ â”‚ ABC123                  â”‚     â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                 â”‚
â”‚ ãƒ¡ãƒ¢ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰               â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚ â”‚                         â”‚     â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                 â”‚
â”‚ ãƒ•ã‚¡ã‚¤ãƒ«                        â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚ â”‚  ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—       â”‚     â”‚
â”‚ â”‚  ã¾ãŸã¯                 â”‚     â”‚
â”‚ â”‚  [ğŸ“ ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ]     â”‚     â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                 â”‚
â”‚ âœ“ eticket.pdf (1.2MB)           â”‚
â”‚                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚      [ã‚­ãƒ£ãƒ³ã‚»ãƒ«]  [ä¿å­˜]        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.6 ã‚«ãƒ†ã‚´ãƒªãƒ¼

| ã‚¢ã‚¤ã‚³ãƒ³ | ã‚«ãƒ†ã‚´ãƒªãƒ¼å | ç”¨é€” |
|---------|------------|------|
| âœˆï¸ | èˆªç©ºåˆ¸ | ãƒ•ãƒ©ã‚¤ãƒˆæƒ…å ±ã€eãƒã‚±ãƒƒãƒˆ |
| ğŸ¨ | ãƒ›ãƒ†ãƒ« | å®¿æ³Šäºˆç´„ç¢ºèªæ›¸ |
| ğŸš— | ãƒ¬ãƒ³ã‚¿ã‚«ãƒ¼ | ãƒ¬ãƒ³ã‚¿ã‚«ãƒ¼äºˆç´„ |
| ğŸš† | äº¤é€šæ©Ÿé–¢ | æ–°å¹¹ç·šã€ãƒã‚¹ãƒã‚±ãƒƒãƒˆ |
| ğŸ“‹ | ä¿é™º | æ—…è¡Œä¿é™ºè¨¼æ›¸ |
| ğŸ“ | ç·Šæ€¥é€£çµ¡å…ˆ | å¤§ä½¿é¤¨ã€ç—…é™¢æƒ…å ± |
| ğŸ« | ãƒã‚±ãƒƒãƒˆ | è¦³å…‰æ–½è¨­ã€ã‚¤ãƒ™ãƒ³ãƒˆ |
| ğŸ“„ | ãã®ä»– | ãƒ“ã‚¶ã€ãƒ‘ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ”ãƒ¼ãªã© |

### 2.7 ãƒ¢ãƒã‚¤ãƒ«å¯¾å¿œ
- ã‚¹ãƒ¯ã‚¤ãƒ—ã§ç·¨é›†ãƒ»å‰Šé™¤ãƒœã‚¿ãƒ³è¡¨ç¤ºï¼ˆã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã¨åŒæ§˜ï¼‰
- ã‚«ãƒ¼ãƒ‰å½¢å¼ã§è¡¨ç¤º
- ã‚¿ãƒƒãƒ—ã§ãƒ¢ãƒ¼ãƒ€ãƒ«è¡¨ç¤º
- ãƒ”ãƒ³ãƒã‚ºãƒ¼ãƒ å¯¾å¿œï¼ˆç”»åƒï¼‰

---

## 3. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ

### 3.1 æ–°è¦ãƒ†ãƒ¼ãƒ–ãƒ«: `travel_documents`

```sql
CREATE TABLE travel_documents (
  id SERIAL PRIMARY KEY,
  itinerary_id INTEGER NOT NULL REFERENCES itineraries(id) ON DELETE CASCADE,
  title VARCHAR(255) NOT NULL,
  category VARCHAR(50) NOT NULL,
  date TIMESTAMP,
  reservation_number VARCHAR(100),
  notes TEXT,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);

-- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
CREATE INDEX idx_travel_documents_itinerary_id ON travel_documents(itinerary_id);
CREATE INDEX idx_travel_documents_category ON travel_documents(category);
```

### 3.2 æ–°è¦ãƒ†ãƒ¼ãƒ–ãƒ«: `document_files`

```sql
CREATE TABLE document_files (
  id SERIAL PRIMARY KEY,
  document_id INTEGER NOT NULL REFERENCES travel_documents(id) ON DELETE CASCADE,
  file_url TEXT NOT NULL,
  file_type VARCHAR(50) NOT NULL, -- 'pdf', 'image'
  file_name VARCHAR(255) NOT NULL,
  file_size INTEGER, -- ãƒã‚¤ãƒˆå˜ä½
  mime_type VARCHAR(100),
  cloudinary_public_id VARCHAR(255), -- Cloudinaryã®ç®¡ç†ID
  display_order INTEGER DEFAULT 0, -- è¤‡æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã®è¡¨ç¤ºé †
  created_at TIMESTAMP DEFAULT NOW()
);

-- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
CREATE INDEX idx_document_files_document_id ON document_files(document_id);
```

### 3.3 ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

```
itineraries (æ—¢å­˜)
    â†“ 1:N
travel_documents (æ–°è¦)
    â†“ 1:N
document_files (æ–°è¦)
```

---

## 4. ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰è¨­è¨ˆ

### 4.1 Cloudinaryè¨­å®š

**ç’°å¢ƒå¤‰æ•°**ï¼ˆ`.env.local`ï¼‰:
```env
NEXT_PUBLIC_CLOUDINARY_CLOUD_NAME=your_cloud_name
CLOUDINARY_API_KEY=your_api_key
CLOUDINARY_API_SECRET=your_api_secret
```

**ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰è¨­å®š**:
- å¯¾å¿œãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ: PDF, JPG, PNG
- æœ€å¤§ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚º: 10MB
- ãƒ•ã‚©ãƒ«ãƒ€æ§‹é€ : `travel-planner/{itinerary_id}/documents/`
- è‡ªå‹•æœ€é©åŒ–: ç”»åƒã®ã¿

### 4.2 ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒ•ãƒ­ãƒ¼

```
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ•ã‚¡ã‚¤ãƒ«é¸æŠ
   â†“
2. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã§ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
   - ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºãƒã‚§ãƒƒã‚¯
   - ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ãƒã‚§ãƒƒã‚¯
   â†“
3. Cloudinaryã¸ç›´æ¥ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
   - unsigned upload ã¾ãŸã¯ signed upload
   â†“
4. ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å®Œäº†å¾Œã€URLã‚’å–å¾—
   â†“
5. GraphQL mutation ã§DBã«ä¿å­˜
   - documentä½œæˆ
   - fileæƒ…å ±ä¿å­˜
```

### 4.3 ãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†

**ä¿å­˜ã•ã‚Œã‚‹æƒ…å ±**:
- `file_url`: Cloudinary URLï¼ˆhttps://res.cloudinary.com/...ï¼‰
- `cloudinary_public_id`: å‰Šé™¤æ™‚ã«ä½¿ç”¨
- `file_type`: ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤ºã®åˆ¤å®šã«ä½¿ç”¨
- `mime_type`: ãƒ–ãƒ©ã‚¦ã‚¶è¡¨ç¤ºç”¨

**å‰Šé™¤æ™‚ã®å‡¦ç†**:
1. DBã‹ã‚‰ãƒ¬ã‚³ãƒ¼ãƒ‰å‰Šé™¤ï¼ˆCASCADEï¼‰
2. Cloudinary APIã§ãƒ•ã‚¡ã‚¤ãƒ«å‰Šé™¤

---

## 5. æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

### 5.1 ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
- **ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰**: `react-dropzone`
- **PDFãƒ“ãƒ¥ãƒ¼ã‚¢ãƒ¼**: `react-pdf` ã¾ãŸã¯ `<iframe>`
- **ç”»åƒãƒ“ãƒ¥ãƒ¼ã‚¢ãƒ¼**: ã‚«ã‚¹ã‚¿ãƒ ãƒ¢ãƒ¼ãƒ€ãƒ« + ãƒ”ãƒ³ãƒã‚ºãƒ¼ãƒ 
- **Cloudinary SDK**: `cloudinary-react` ã¾ãŸã¯ç›´æ¥APIå‘¼ã³å‡ºã—

### 5.2 ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
- **Hasura**: GraphQL mutations/queries
- **Cloudinary**: ãƒ•ã‚¡ã‚¤ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãƒ»CDN

### 5.3 ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ï¼ˆè¿½åŠ ï¼‰

```json
{
  "dependencies": {
    "react-dropzone": "^14.2.3",
    "react-pdf": "^7.7.0",
    "cloudinary": "^2.0.0"
  }
}
```

---

## 6. GraphQL APIè¨­è¨ˆ

### 6.1 Queries

```graphql
# å…¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå–å¾—
query GetTravelDocuments($itinerary_id: Int!) {
  travel_documents(
    where: { itinerary_id: { _eq: $itinerary_id } }
    order_by: { created_at: desc }
  ) {
    id
    title
    category
    date
    reservation_number
    notes
    created_at
    files: document_files(order_by: { display_order: asc }) {
      id
      file_url
      file_type
      file_name
      file_size
      mime_type
      display_order
    }
  }
}

# ã‚«ãƒ†ã‚´ãƒªãƒ¼åˆ¥å–å¾—
query GetDocumentsByCategory($itinerary_id: Int!, $category: String!) {
  travel_documents(
    where: {
      itinerary_id: { _eq: $itinerary_id }
      category: { _eq: $category }
    }
    order_by: { date: asc }
  ) {
    id
    title
    category
    date
    reservation_number
    notes
    files: document_files(order_by: { display_order: asc }) {
      id
      file_url
      file_type
      file_name
      file_size
    }
  }
}

# å˜ä¸€ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå–å¾—
query GetTravelDocument($id: Int!) {
  travel_documents_by_pk(id: $id) {
    id
    title
    category
    date
    reservation_number
    notes
    created_at
    files: document_files(order_by: { display_order: asc }) {
      id
      file_url
      file_type
      file_name
      file_size
      mime_type
      cloudinary_public_id
      display_order
    }
  }
}
```

### 6.2 Mutations

```graphql
# ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä½œæˆ
mutation InsertTravelDocument(
  $itinerary_id: Int!
  $title: String!
  $category: String!
  $date: timestamp
  $reservation_number: String
  $notes: String
  $files: [document_files_insert_input!]!
) {
  insert_travel_documents_one(
    object: {
      itinerary_id: $itinerary_id
      title: $title
      category: $category
      date: $date
      reservation_number: $reservation_number
      notes: $notes
      files: { data: $files }
    }
  ) {
    id
    title
    files {
      id
      file_url
      file_type
      file_name
    }
  }
}

# ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ›´æ–°
mutation UpdateTravelDocument(
  $id: Int!
  $title: String
  $category: String
  $date: timestamp
  $reservation_number: String
  $notes: String
) {
  update_travel_documents_by_pk(
    pk_columns: { id: $id }
    _set: {
      title: $title
      category: $category
      date: $date
      reservation_number: $reservation_number
      notes: $notes
      updated_at: "now()"
    }
  ) {
    id
    title
    updated_at
  }
}

# ãƒ•ã‚¡ã‚¤ãƒ«è¿½åŠ 
mutation InsertDocumentFile(
  $document_id: Int!
  $file_url: String!
  $file_type: String!
  $file_name: String!
  $file_size: Int
  $mime_type: String
  $cloudinary_public_id: String
  $display_order: Int
) {
  insert_document_files_one(
    object: {
      document_id: $document_id
      file_url: $file_url
      file_type: $file_type
      file_name: $file_name
      file_size: $file_size
      mime_type: $mime_type
      cloudinary_public_id: $cloudinary_public_id
      display_order: $display_order
    }
  ) {
    id
    file_url
    file_name
  }
}

# ãƒ•ã‚¡ã‚¤ãƒ«å‰Šé™¤
mutation DeleteDocumentFile($id: Int!) {
  delete_document_files_by_pk(id: $id) {
    id
    cloudinary_public_id
  }
}

# ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå‰Šé™¤
mutation DeleteTravelDocument($id: Int!) {
  delete_travel_documents_by_pk(id: $id) {
    id
    files {
      cloudinary_public_id
    }
  }
}
```

---

## 7. å®Ÿè£…æ‰‹é †

### Phase 1: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æº–å‚™
1. âœ… ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ
   - `travel_documents` ãƒ†ãƒ¼ãƒ–ãƒ«
   - `document_files` ãƒ†ãƒ¼ãƒ–ãƒ«
2. âœ… Hasuraã§ãƒ†ãƒ¼ãƒ–ãƒ«è¿½è·¡
3. âœ… ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®š
4. âœ… ãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³è¨­å®š

### Phase 2: GraphQL API
1. âœ… queries.tsã«è¿½åŠ 
   - `GET_TRAVEL_DOCUMENTS`
   - `GET_TRAVEL_DOCUMENT`
2. âœ… mutates.tsã«è¿½åŠ 
   - `INSERT_TRAVEL_DOCUMENT`
   - `UPDATE_TRAVEL_DOCUMENT`
   - `DELETE_TRAVEL_DOCUMENT`
   - `INSERT_DOCUMENT_FILE`
   - `DELETE_DOCUMENT_FILE`

### Phase 3: Cloudinaryè¨­å®š
1. âœ… Cloudinaryã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ
2. âœ… ç’°å¢ƒå¤‰æ•°è¨­å®š
3. âœ… ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒ—ãƒªã‚»ãƒƒãƒˆè¨­å®š
4. âœ… ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°ä½œæˆ

### Phase 4: ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå®Ÿè£…
1. âœ… `InformationContent.tsx` - ãƒ¡ã‚¤ãƒ³ç”»é¢
2. âœ… `AddDocumentModal.tsx` - è¿½åŠ ãƒ¢ãƒ¼ãƒ€ãƒ«
3. âœ… `DocumentCard.tsx` - ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚«ãƒ¼ãƒ‰
4. âœ… `DocumentViewerModal.tsx` - PDF/ç”»åƒãƒ“ãƒ¥ãƒ¼ã‚¢ãƒ¼
5. âœ… `FileUploader.tsx` - ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

### Phase 5: çµ±åˆ
1. âœ… ã‚¿ãƒ–ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã«ã€Œæƒ…å ±ã€è¿½åŠ 
2. âœ… ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°è¨­å®š
3. âœ… ã‚¹ãƒ¯ã‚¤ãƒ—æ©Ÿèƒ½å®Ÿè£…
4. âœ… ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

### Phase 6: ãƒ†ã‚¹ãƒˆãƒ»èª¿æ•´
1. âœ… ãƒ¢ãƒã‚¤ãƒ«è¡¨ç¤ºç¢ºèª
2. âœ… PDFãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼å‹•ä½œç¢ºèª
3. âœ… ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒ»å‰Šé™¤ç¢ºèª
4. âœ… ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

---

## 8. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è€ƒæ…®äº‹é …

### 8.1 ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
- ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºåˆ¶é™: 10MB
- è¨±å¯ã™ã‚‹æ‹¡å¼µå­: `.pdf`, `.jpg`, `.jpeg`, `.png`
- MIMEã‚¿ã‚¤ãƒ—æ¤œè¨¼
- ã‚¦ã‚¤ãƒ«ã‚¹ã‚¹ã‚­ãƒ£ãƒ³ï¼ˆæœ¬ç•ªç’°å¢ƒã§ã¯æ¤œè¨ï¼‰

### 8.2 ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡
- itinerary_idã«ã‚ˆã‚‹æ¨©é™ãƒã‚§ãƒƒã‚¯
- ã‚°ãƒ«ãƒ¼ãƒ—ãƒ¡ãƒ³ãƒãƒ¼ã®ã¿ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½
- Hasuraã®ãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³è¨­å®š

### 8.3 å€‹äººæƒ…å ±ä¿è­·
- ãƒ‘ã‚¹ãƒãƒ¼ãƒˆæƒ…å ±ãªã©ã®å–ã‚Šæ‰±ã„æ³¨æ„
- äºˆç´„ç•ªå·ã®ãƒã‚¹ã‚­ãƒ³ã‚°æ¤œè¨
- HTTPSé€šä¿¡å¿…é ˆ

---

## 9. å°†æ¥ã®æ‹¡å¼µæ¡ˆ

### 9.1 æ©Ÿèƒ½æ‹¡å¼µ
- OCRæ©Ÿèƒ½ï¼ˆäºˆç´„ç•ªå·ã®è‡ªå‹•æŠ½å‡ºï¼‰
- ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼é€£æº
- ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼é€šçŸ¥
- QRã‚³ãƒ¼ãƒ‰ç”Ÿæˆï¼ˆç©ºæ¸¯ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³ç”¨ï¼‰
- ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å¯¾å¿œ

### 9.2 UIæ”¹å–„
- ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰å¯¾å¿œ
- ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ä¸¦ã³æ›¿ãˆ
- ä¸€æ‹¬ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼ˆZIPï¼‰
- å°åˆ·ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆæœ€é©åŒ–

---

## 10. å‚è€ƒè³‡æ–™

- [Cloudinary Documentation](https://cloudinary.com/documentation)
- [react-dropzone](https://react-dropzone.js.org/)
- [react-pdf](https://github.com/wojtekmaj/react-pdf)
- [Hasura Permissions](https://hasura.io/docs/latest/auth/authorization/permissions/)

---

**ä½œæˆæ—¥**: 2026-01-10
**æœ€çµ‚æ›´æ–°**: 2026-01-10
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: è¨­è¨ˆå®Œäº† â†’ å®Ÿè£…å¾…ã¡
